# 機能一覧

## 1. ユーザー認証

### サインアップ
- メールアドレスとパスワードによる登録
- カテゴリ選択（高校生、大学生、社会人選手、監督・コーチ、運営）
- 自動的にプロフィール作成（Supabaseトリガー）
- ログイン時に利用ログを自動記録

### サインイン
- メール/パスワード認証
- セッション管理（自動更新）
- ログイン/ログアウト時刻の記録

## 2. 運営画面（/admin）

### アクセス制限
- カテゴリが「運営」のユーザーのみアクセス可能

### 大会管理
- 大会一覧の表示
- 大会の選択

### 試技順管理
- リアルタイムで試技順を表示
- バーベル・ローデッド法による自動ソート:
  - 重量（軽い順）
  - 試技回数（少ない順）
  - 抽選番号（小さい順）

### 試技結果入力
- 「進行中」の試技を設定
- 成功/失敗の結果入力
- 結果入力後、自動的に次の試技へ

### リアルタイム同期
- Supabase Realtimeで全クライアントに即座に反映
- 複数の運営者が同時に操作可能

## 3. 選手画面（/athlete）

### 大会・選手選択
- アクティブな大会の一覧
- 選手名による検索・選択

### 現在のバー重量表示
- 進行中の試技の重量を大きく表示
- 選手名、種目、試技回数も表示

### 待機本数表示
- **自分があと何本待ちか**を大きく表示
- 計算ロジック:
  - 自分より前の選手との重量差を計算
  - Zone設定に基づいて予測試技数を加算:
    - 差 >= 8kg: +3本
    - 差 >= 4kg: +2本
    - 差 >= 0kg: +1本
  - ただし、その選手の残り試技数を超えない

### 次の試技順表示
- 次の5人の試技順を表示
- 選手名、種目、重量

### 自分より前の選手
- 各選手の重量と予測試技数を表示
- 待機本数の内訳を確認可能

### リアルタイム更新
- 試技結果が入力されると即座に更新
- 待機本数も自動再計算

## 4. データベース機能

### competitions（大会）
- 大会名、日付、ステータス
- 待機本数計算用の設定値（Zone A, B, C）

### athletes（選手）
- 選手名、体重、抽選番号
- スナッチ/ジャーク第1試技重量
- グループ分け

### attempts（試技）
- 試技種目、回数、申告重量
- 結果（pending/success/fail/skip）
- 進行中フラグ

### profiles（プロフィール）
- ユーザー情報
- カテゴリによる権限管理

### usage_logs（利用ログ）
- ログイン/ログアウト時刻
- デバイス情報（UserAgent）

## 5. UI/UXの特徴

### モバイルファースト
- スマホで見やすい大きな文字
- タッチ操作に最適化
- レスポンシブデザイン

### カード型デザイン
- 情報をカードで整理
- 視認性の高いレイアウト

### リアルタイム性
- 試技結果が即座に反映
- 待機本数が自動更新
- ローディング表示

## 6. セキュリティ

### Row Level Security (RLS)
- Supabaseのポリシーで行レベルのアクセス制御
- 運営者のみが編集可能
- 全ユーザーが閲覧可能

### 認証
- Supabase Authによる安全な認証
- セッション管理
- XSS/CSRF対策

## 7. パフォーマンス

### 最適化
- Next.js 14の最新機能
- App Routerによる効率的なルーティング
- サーバーコンポーネントの活用

### インデックス
- 頻繁に検索されるカラムにインデックス
- クエリの高速化

## 今後の拡張可能性

### 実装予定機能
- 重量変更機能
- 選手データのCSVインポート
- 大会結果のPDFエクスポート
- プロフィールと選手の紐付け
- グループ別の進行管理
- 記録の統計・分析
- モバイルアプリ化（PWA）
